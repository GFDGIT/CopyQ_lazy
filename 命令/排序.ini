[Command]
Name=\x6392\x5e8f
Command="
    copyq:
    // \x5355\x9009\x6761\x76ee\x65f6\x5bf9\x6574\x4e2a\x6807\x7b7e\x9875\x8fdb\x884c\x6392\x5e8f
    // \x591a\x9009\x6761\x76ee\x65f6\x5bf9\x9009\x4e2d\x7684\x6761\x76ee\x8fdb\x884c\x6392\x5e8f
    var date = {
        [mimeText]: '\x6700\x65e7\x5728\x524d',
        [mimeIcon]: '\xf017',
        format: \"application/x-copyq-user-copy-time\",
        reverse: false
    }
    var date_reverse = {
        [mimeText]: '\x6700\x65b0\x5728\x524d',
        [mimeIcon]: '\xf1da',
        format: \"application/x-copyq-user-copy-time\",
        reverse: true
    }
    var alphabet = {
        [mimeText]: '\x5b57\x6bcd\x987a\x5e8f',
        [mimeIcon]: '\xf15d',
        format: mimeText,
        reverse: false
    }
    var alphabet_reverse = {
        [mimeText]: '\x5b57\x6bcd\x5012\x5e8f',
        [mimeIcon]: '\xf881',
        format: mimeText,
        reverse: true
    }

    var size_reverse = {
        [mimeText]: '\x4ece\x5927\x5230\x5c0f',
        [mimeIcon]: '\xf160',
        format: \"ItemSize\",
        reverse: true
    }

    var size = {
        [mimeText]: '\x4ece\x5c0f\x5230\x5927',
        [mimeIcon]: '\xf884',
        format: \"ItemSize\",
        reverse: false
    }

    var sel = ItemSelection().current()
    if (sel.length <= 1) {
        sel = ItemSelection().selectAll()
    }
    var sorts = [date_reverse, date, alphabet, alphabet_reverse, size_reverse, size]
    var selectedIndex = menuItems(sorts)
    var texts = ''
    if (selectedIndex != -1) {
        var selectedFormat = sorts[selectedIndex].format
        if (selectedFormat == 'ItemSize') {
            popup('\x6392\x5e8f\x4e2d\xff0c\x8bf7\x7a0d\x5019\xff01','',1500)
            texts = Sizelist()
        } else {
            texts = sel.itemsFormat(selectedFormat)
        }
    } else {
        abort()
    }
    sel.sort(function (i, j) {
        if (sorts[selectedIndex].reverse) {
            return texts[i] > texts[j];
        } else {
            return texts[i] < texts[j];
        }
    });
    popup('\x6392\x5e8f\x5b8c\x6210\xff01','',1500)


    function Sizelist() {
        var items = sel.items()
        var rows = sel.rows()
        var sizes = []
        for (let row in rows) {
            var itemSize = 0
            var item = items[row]
            for (var format in item) {
                itemSize += read(format, row).size()
            }
            sizes.push(itemSize)
        }
        return sizes
    }"
InMenu=true
Icon=\xf0dc
Shortcut=s