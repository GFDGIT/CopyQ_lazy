[Command]
Name=获取屏幕分辨率
Command="
    global.getScreenResolution = function () {
        var x = 0
        var y = 0
        popup('正在获取屏幕分辨率... ', '鼠标指针自动移动是正常现象。\\n预计耗时大于30s，请耐心等待！', 15000)
        var i = 3
        while (i > -1) {
            try {
                x += 10 ** i
                setPointerPosition(x, y)
            } catch (error) {
                x -= 10 ** i
                i--
            }
        }
        i = 3
        while (i > -1) {
            try {
                y += 10 ** i
                setPointerPosition(x, y)
            } catch (error) {
                y -= 10 ** i
                i--
            }
        }
        setPointerPosition(++x / 2, ++y / 2)
        popup('屏幕分辨率为：' + [x, y])
        return [x, y]
    }

    const onStart_ = global.onStart
    global.onStart = function () {
        onStart_()
        if (!settings('ScreenResolution')) {
            settings('ScreenResolution', getScreenResolution())
        }
    }"
IsScript=true
Icon=